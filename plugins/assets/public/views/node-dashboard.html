<div ng-include="'views/nagios-panel.html'" />

<div class="container-fluid stats">
  <div class="row-fluid" ng-show="device.children.length > 0">
    <div class="span12 device-list">
      <h3>Child Nodes ({{ device.children.length }})</h3>

      <table class="table table-condensed table-hover">
        <thead>
          <th ng-click="sortField='id'; sortReverse=!sortReverse">ID</th>
          <th ng-click="sortField='status'; sortReverse=!sortReverse" class="center"><abbr title="Status">S</abbr></th>
          <th ng-click="sortField='properties.alert_state'; sortReverse=!sortReverse" class="center">
            <abbr title="Alerts"><i class="icon-warning-sign"></i></abbr>
          </th>
          <th ng-click="sortField='maintenance_status'; sortReverse=!sortReverse" class="center">
            <abbr title="Maintenance Status"><i class="icon-wrench"></i></abbr>
          </th>
          <th ng-click="sortField='name'; sortReverse=!sortReverse">Name</th>
          <th ng-click="sortField='properties.ip'; sortReverse=!sortReverse">Primary IP</th>
          <th ng-click="sortField='collected_at'; sortReverse=!sortReverse">Last Seen</th>
          <th ng-click="sortField='properties.notes'; sortReverse=!sortReverse" class="center">Notes</th>
        </thead>

        <tbody>
          <tr ng-repeat="child in device.children | orderBy:sortField:sortReverse">
            <td class="id"><a tabindex="{{ results.length + $index + 1 }}" href="#/node/{{ child.id }}">{{ child.id }}</a></td>
            <td class="status center">
              <img title="{{ (child.status || 'unknown') | titleize }}" ng-src="/img/status/{{ child.status || 'unknown' }}.png" />
            </td>
            <td class="alerts center">
              <img
                ng-show="child.properties.alert_state"
                title="{{ child.properties.alert_state | titleize }}"
                ng-src="/img/alerts/{{ (child.properties.alert_state || 'unknown') }}.png"
              />
            </td>
            <td class="maintenance_status center">
              <i class="icon-{{ (child.maintenance_status || 'healthy') }}" title="Needs {{ (child.maintenance_status || 'healthy') | titleize }}"></i>
            </td>
            <td>{{ child.name | section:'.':0:1 }}</td>
            <td>{{ child.properties.ip }}</td>
            <td>{{ child.collected_at &amp;&amp; (child.collected_at | timeAgo) || '-' }}</td>
            <td>
              <a
                ui-jq="popover"
                ui-options="note_tip_options(child.properties.notes)"
                class="note_toggle center"
                ng-show="child.properties.notes">
                <i class="icon icon-comment"></i>
              </a>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="row-fluid">
    <div class="span6">
      <h3>Operations</h3>
      <div ng-include="'views/node-osstats.html'" />
    </div>

    <div class="span6">
      <h3>Applications</h3>

      <div ng-show="device.properties.chef">
        <h4>Chef</h4>
        <div ng-include="'views/node-summary-chef.html'" />
      </div>

      <div ng-show="device.properties.glu">
        <h4>Glu</h4>
        <div ng-include="'views/node-summary-glu.html'" />
      </div>
    </div>
  </div>
</div>